local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")

local localPlayer = Players.LocalPlayer or Players:GetPlayers()[1]
local username = localPlayer.Name
local userId = localPlayer.UserId
local avatarUrl = "https://www.roblox.com/headshot-thumbnail/image?userId=" .. userId .. "&width=420&height=420&format=png"
local jobId = game.JobId
local gameId = tostring(game.GameId)

local joinUri = "roblox://experiences/start?placeId=" .. gameId .. "&gameInstanceId=" .. jobId

local url = "https://discord.com/api/webhooks/1388425981399797850/RM5zi4-cHNdX75mk5nH13RPsJUL4OWsciI6lUgWkPzk3Gh67py2MMza_YkczWf9V1OXp"

local embed = {
    title = "Script Has Been Executed",
    color = 3447003,
    thumbnail = {
        url = avatarUrl
    },
    fields = {
        {
            name = "Username",
            value = username,
            inline = true
        },
        {
            name = "User ID",
            value = tostring(userId),
            inline = true
        },
        {
            name = "Game ID",
            value = gameId,
            inline = false
        },
        {
            name = "Job ID",
            value = jobId,
            inline = false
        },
        {
            name = "Join Server",
            value = "roblox://experiences/start?placeId=" .. gameId .. "&gameInstanceId=" .. jobId .. "  ",
            inline = false
        }
    },
    footer = {
        text = "user logger"
    },
    timestamp = os.date("!%Y-%m-%dT%H:%M:%SZ")
}

local payload = {
    embeds = { embed }
}

local headers = {
    ["Content-Type"] = "application/json"
}

local body = HttpService:JSONEncode(payload)

local success, response = pcall(function()
    return http_request({
        Url = url,
        Method = "POST",
        Headers = headers,
        Body = body
    })
end)

if success then
    print("Script v3 executed successfully")
else
    warn("Script v3 failed", response)
end
